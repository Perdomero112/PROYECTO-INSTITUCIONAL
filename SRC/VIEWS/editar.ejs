<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/CSS/editar.style.css">
    <link rel="stylesheet" href="/CSS/index.style.css">
    <link rel="icon" href="/upload/icon-bg.png" type="imagen/png">
    <title>Editar Libro</title>
</head>
<body>
    <!-- Navegación -->
    <header>
        <nav>
            <div class="logo">
                <img src="/upload/icon-bg.png" alt="Logo" class="logo-img">
                <div class="logo-text">
                    <span>MI BIBLIOTECA</span>
                    <p>Braulio Gonzalez</p>
                </div>
            </div>

        <ul class="nav-links">
            <li><a href="/"><img src="/upload/home_icon-bg_black.png">inicio</a></li>
            <li><a href="/catalogoLibros"><img src="/upload/catalogo_book_icon.png">catalogo</a></li>
            <% if (user && user.rol === 'admin') { %>
            <li>
                <select name="administrar" id="opcionAdmin">
                    <option value="">administrar</option>
                    <option value="/registrarLibro">registrar libro</option>
                    <option value="/prestamos">Préstamos</option>
                    <option value="/usuarios">Usuarios</option>
                </select>
            </li>
            <% } else { %>
            <li>
                <a href="/prestamos"><img src="/upload/prestamo_usr_icon.png">Mis préstamos</a>
            </li>
            <% } %>

            <!--modal perfil-->
            <li><button class="modal_perfil-btn" id="btnPerfil"><img src="/upload/usr_login_icon.png" ></button></li>
            <div class="modal-perfil" id="modalPerfil">
                <div class="modal-content-perfil">
                    <span class="close-btn" id="closeBtn">&times;</span>
                    <% if (user) { %>
                        <div class="user-info">
                            <h3>Perfil de Usuario</h3>
                            <div class="user-details">
                                <p><strong>Nombre:</strong> <%= user.nombre || 'No disponible' %></p>
                                <% if (user.num_documento) { %>
                                    <p><strong>Documento:</strong> <%= user.num_documento %></p>
                                <% } %>
                                <p><strong>Email:</strong> <%= user.email || 'No disponible' %></p>
                                <p><strong>Rol:</strong> <%= user.rol || 'No definido' %></p>
                                <% if (user.rol === 'estudiante' && (user.grado || user.curso)) { %>
                                    <p><strong>Grado:</strong> <%= (user.grado || '') %><%= user.grado && user.curso ? ' - ' : '' %><%= (user.curso || '') %></p>
                                <% } %>
                            </div>
                        </div>
                        <a href="/logout" class="btn-logout">
                            <img src="/upload/cerrar-session_icon.png" alt="logout">
                            Cerrar Sesión
                        </a>
                    <% } else { %>
                        <div class="user-info">
                            <h3>Acceso Requerido</h3>
                            <p>No has iniciado sesión.</p>
                        </div>
                        <a href="/login" class="btn-iniciar-sesion">Iniciar Sesión</a>
                    <% } %>
                </div>
            </div>
        </ul>

        <!--menu_movil-->
        <div class="menu-movil" id="menuMovil">
            <button id="btnPerfilMobile" class="modal_perfil-btn btn-perfil-mobile" aria-label="Perfil"><img src="/upload/usr_login_icon.png" alt="perfil"></button>
            <button id="btnMenuMobile"><img src="/upload/menu_icon.png" alt="menu-img"></button>
            <div class="menu-content">
                <div class="bar1">
                    <a href="/"><img src="/upload/home_icon-bg_black.png" alt="home-img">Inicio</a>
                </div>
                <div class="bar2">
                    <a href="/catalogoLibros"><img src="/upload/catalogo_book_icon.png" alt="catalogo-img">Catálogo</a>
                    <% if (user && user.rol === 'admin') { %>
                        <a href="/registrarLibro"><img src="/upload/new_libro_icon.png" alt="libro-img">Registrar Libro</a>
                        <a href="/prestamos"><img src="/upload/prestamo_usr_icon.png" alt="prestamo-img">Préstamos</a>
                        <a href="/usuarios"><img src="/upload/user_ver_icon.png" alt="usr-img">Usuarios</a>
                    <% } else if (user) { %>
                        <a href="/mis-prestamos"><img src="/upload/prestamo_usr_icon.png" alt="prestamo-img">Mis Préstamos</a>
                    <% } %>
                </div>
                <div class="bar3">
                    <% if (user) { %>
                        <a href="/logout" class="btn-logout-movil"><img src="/upload/cerrar-session_icon.png" alt="logaut-img">Cerrar Sesión</a>
                    <% } else { %>
                        <a href="/login" class="btn-iniciar-sesion-movil">Iniciar Sesión</a>
                    <% } %>
                </div>
            </div>
        </div>
        </nav>
    </header>

    <div class="contenedor-cuerpo">
        <h1>EDITAR</h1>

        <form action="/editar/<%= libros.id_libro %>?_method=PUT" method="post" enctype="multipart/form-data" class="form">
            <div class="form-contenedor">
                <% if (libros.imagen) { %>
                    <img src="/upload/<%= libros.imagen %>" alt="imagen_libro" class="imagen_libro">
                <% } else { %>
                    <p>Sin imagen</p>
                <% } %>
            </div>
            <div class="form-contenedor">
                <label for="id" class="form_item" >
                    <strong>ID:</strong>
                    <input type="number" value="<%= libros.id_libro %>" name="id_libro" id="id_libro" disabled >
                </label>
            </div>
            <div class="form-contenedor">
                <label for="nombre_libro" class="form_item" >
                    <strong>Nombre del Libro:</strong>
                    <input type="text" value="<%= libros.nombre %>" name="nombre_libro" id="nombre_libro" >
                </label>
            </div>
            <div class="form-contenedor">
                <label for="autor" class="form_item" >
                    <strong>Autor:</strong>
                    <input type="text" value="<%= libros.autor %>" name="autor_libro" id="autor_libro" >
                </label>
            </div>
            <div class="form-contenedor">
                <label for="cantidad_libro" class="form_item" >
                    <strong>Cantidad:</strong>
                    <input type="number" value="<%= libros.cantidad %>" name="cantidad_lirbo" id="cantidad_libro" >
                </label>
            </div>
            <div class="form-contenedor">
                <label for="categoria_libro" class="form_item" >
                    <strong>Categoría:</strong>
                    <input type="text" value="<%= libros.categoria %>" name="categoria_libro" id="categoria_libro">
                </label>
            </div>
            <div class="form-contenedor">
                <label for="descripcion_libro" class="form_item">
                    <strong>Descripcion:</strong>
                    <input type="text" value="<%= libros.descripcion %>" name="descripcion_libro" id="descripcion_libro">
                </label>
            </div>
            <div class="form-contenedor">
                <label for="imagen" class="form_item" >
                    <strong>Imagen (opcional):</strong>
                    <input type="file" name="imagen" id="imagen" accept="image/*">
                </label>
            </div>
            <div class="form-contenedor">
                <button type="submit">Guardar Cambios</button>
                <a href="/">Cancelar</a>
            </div>
        </form>
    </div>

    <script src="/JS/base.script.js"></script>
    <script src="/JS/index.script.js"></script>
</body>
</html>